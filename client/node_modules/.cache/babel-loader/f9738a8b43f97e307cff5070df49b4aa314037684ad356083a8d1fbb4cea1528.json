{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/home/salman/Documents/GitHub/FakeShop/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.redactConnectionString = exports.redactValidConnectionString = void 0;\nvar index_1 = __importStar(require(\"./index\"));\nfunction redactValidConnectionString(inputUrl, options) {\n  var _a, _b;\n  var url = inputUrl.clone();\n  var replacementString = (_a = options === null || options === void 0 ? void 0 : options.replacementString) !== null && _a !== void 0 ? _a : '_credentials_';\n  var redactUsernames = (_b = options === null || options === void 0 ? void 0 : options.redactUsernames) !== null && _b !== void 0 ? _b : true;\n  if ((url.username || url.password) && redactUsernames) {\n    url.username = replacementString;\n    url.password = '';\n  } else if (url.password) {\n    url.password = replacementString;\n  }\n  if (url.searchParams.has('authMechanismProperties')) {\n    var props = new index_1.CommaAndColonSeparatedRecord(url.searchParams.get('authMechanismProperties'));\n    if (props.get('AWS_SESSION_TOKEN')) {\n      props.set('AWS_SESSION_TOKEN', replacementString);\n      url.searchParams.set('authMechanismProperties', props.toString());\n    }\n  }\n  if (url.searchParams.has('tlsCertificateKeyFilePassword')) {\n    url.searchParams.set('tlsCertificateKeyFilePassword', replacementString);\n  }\n  if (url.searchParams.has('proxyUsername') && redactUsernames) {\n    url.searchParams.set('proxyUsername', replacementString);\n  }\n  if (url.searchParams.has('proxyPassword')) {\n    url.searchParams.set('proxyPassword', replacementString);\n  }\n  return url;\n}\nexports.redactValidConnectionString = redactValidConnectionString;\nfunction redactConnectionString(uri, options) {\n  var _a, _b;\n  var replacementString = (_a = options === null || options === void 0 ? void 0 : options.replacementString) !== null && _a !== void 0 ? _a : '<credentials>';\n  var redactUsernames = (_b = options === null || options === void 0 ? void 0 : options.redactUsernames) !== null && _b !== void 0 ? _b : true;\n  var parsed;\n  try {\n    parsed = new index_1.default(uri);\n  } catch (_c) {}\n  if (parsed) {\n    options = _objectSpread(_objectSpread({}, options), {}, {\n      replacementString: '___credentials___'\n    });\n    return parsed.redact(options).toString().replace(/___credentials___/g, replacementString);\n  }\n  var R = replacementString;\n  var replacements = [function (uri) {\n    return uri.replace(redactUsernames ? /(\\/\\/)(.*)(@)/g : /(\\/\\/[^@]*:)(.*)(@)/g, \"$1\".concat(R, \"$3\"));\n  }, function (uri) {\n    return uri.replace(/(AWS_SESSION_TOKEN(:|%3A))([^,&]+)/gi, \"$1\".concat(R));\n  }, function (uri) {\n    return uri.replace(/(tlsCertificateKeyFilePassword=)([^&]+)/gi, \"$1\".concat(R));\n  }, function (uri) {\n    return redactUsernames ? uri.replace(/(proxyUsername=)([^&]+)/gi, \"$1\".concat(R)) : uri;\n  }, function (uri) {\n    return uri.replace(/(proxyPassword=)([^&]+)/gi, \"$1\".concat(R));\n  }];\n  for (var _i = 0, _replacements = replacements; _i < _replacements.length; _i++) {\n    var replacer = _replacements[_i];\n    uri = replacer(uri);\n  }\n  return uri;\n}\nexports.redactConnectionString = redactConnectionString;","map":{"version":3,"names":["index_1","__importStar","require","redactValidConnectionString","inputUrl","options","url","clone","replacementString","_a","redactUsernames","_b","username","password","searchParams","has","props","CommaAndColonSeparatedRecord","get","set","toString","exports","redactConnectionString","uri","parsed","default","_c","_objectSpread","redact","replace","R","replacements","concat","_i","_replacements","length","replacer"],"sources":["../src/redact.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}